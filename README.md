<p align="center">
  <img src="./public/img/favicon.svg" alt="Logo of Kirby + Vue.js 3 Starterkit" width="114" height="114">
</p>

<h3 align="center">Kirby + Vue.js 3 Starterkit</h3>

<p align="center">
  SPA with Vue.js 3 and Kirby. Uses Vite as web dev build tool.<br>
  <a href="https://kirby-vue3-starterkit.jhnn.dev"><strong>Explore the starterkit live »</strong></a>
</p>

<br>

## Kirby + Vue.js 3 Starterkit

### Key Features

- 🖖 Vue.js 3 powered
- ⚡️ [Vite](https://github.com/vitejs/vite) in favour of Vue.js CLI
- ♿ Accessible routing
- 🔍 SEO-friendly ([server-side generated](site/snippets/meta.php) meta tags)
- 🤝 Shared `.env` file for frontend & backend
- 🗃️ Centralized state management without Vuex
- 🚀 Modern Kirby folder setup

### Introduction

This project is a starting point for [Vue.js v3](https://github.com/vuejs/vue-next) as the frontend UI library and [Kirby](https://getkirby.com) as headless CMS. The content is provided as JSON through Kirby and fetched by the frontend.

It's a simple, zero-setup, almost identical port of the [Kirby 3 starterkit](https://github.com/getkirby/starterkit) frontend (snippets, templates and their corresponding JS/CSS) to Vue.js single file components. By "almost" meaning that some features have been added like meta tags generation, environment variables support, accessible routing etc.

To compile the frontend sources, [Vite](https://github.com/vitejs/vite) comes to use. Vite is an opinionated web development build tool, created by Evan You. It serves code via native ES Module imports during development, allowing you to develop Vue.js single file components without a bundle step, and bundles it with Rollup for production. Features include:
- Lightning fast cold server start
- Instant hot module replacement (HMR)
- [Head over to the GitHub page](https://github.com/vitejs/vite) for more details

### Folder structure

Some notes about the folder structure with some additional comments on important files.

```sh
kirby-vue3-starterkit/
|
|   # Includes all frontend-related files
├── frontend/
|   |
|   |   # Vue.js sources
|   ├── src/
|   |   |
|   |   |   # `Footer`, `Header` and `Intro` components
|   |   |   # (Vue.js components correspond to Kirby snippets)
|   |   ├── components/
|   |   |
|   |   |   # Hooks for common actions
|   |   ├── hooks/
|   |   |   |
|   |   |   |   # Handle retrieval of JSON content representations
|   |   |   ├── kirby-api.js
|   |   |   |
|   |   |   |   # Roughly corresponds to the Kirby's `$page` object
|   |   |   └── page.js
|   |   |
|   |   |   # Minimal store to cache page data fetched via api (Vuex-free)
|   |   ├── store/
|   |   |
|   |   |   # Vue.js views correspond to Kirby templates
|   |   |   # Routes are being automatically resolved 
|   |   ├── views/
|   |   |
|   |   ├── App.vue
|   |   ├── main.js
|   |   └── router.js
|   |
|   |   # Index page used by Vite in development environment
|   └── index.html
|
|   # The main entry point of the website
|   # Therefore web servers can only access files based in that directory
├── public/
|   |
|   |   # JavaScript and CSS assets generated by Vite (not tracked)
|   ├── assets/
|   |
|   |   # Static images for web manifest and PWA icons
|   ├── img/
|   |
|   |   # Kirby's media folder for thumbnails and more (contents not tracked)
|   └── media/
|
|   # Kirby's core folder containing templates, blueprints, snippets etc. for Kirby
├── site/
|   ├── blueprints/
|   ├── config/
|   ├── models/
|   ├── plugins/
|   ├── snippets/
|   |   |
|   |   |   # Other files
|   |   ├── [...]
|   |   |
|   |   |   # Index page used by Kirby in production environment
|   |   |   # Except for asset loading identical to `frontend/index.html`
|   |   └── index.php
|   |
|   |   # Templates for JSON content representations fetched by frontend
|   └── templates/
|
|   # Contains everything content and user data related (contents of each directory are not tracked)
├── storage/
|   ├── accounts/
|   ├── cache/
|   ├── content/
|   └── sessions/
|
|   # Kirby CMS and other PHP dependencies handled by Composer
├── vendor/
|
|   # Shared environment variables accessible from both Kirby and Vue.js
├── .env
|
|   # Handles PHP dependencies
├── composer.json
|
|   # Handles NPM dependencies
├── package.json
|
|   # Node script to start a PHP server for Kirby
├── serve-kirby.js
|
|   # Router for the PHP built-in development server (used by the script above)
├── server.php
|
|   # Configuration file for Vite
└── vite.config.js
```

## Prerequisites

- Node.js with npm (only required to build the frontend)
- Kirby requires PHP 7.2+

> Kirby is not a free software. You can try it for free on your local machine but in order to run Kirby on a public server you must purchase a [valid license](https://getkirby.com/buy).

## Setup

Install npm dependencies.

```bash
npm install
```

**Note**: Composer dependencies are tracked in this repository by default. Running `composer install` isn't necessary.

## Usage

### Serve backend & frontend for development

```bash
# Same as `npm run kirby:serve` and `npm run dev` but run in parallel
npm run start
```

Out of the box the backend is automatically served while developing. `npm run kirby:serve` spawns a PHP built-in web server by Node. You can also serve the backend by a web server of your choice. If done so, please specify hostname and port in the [`.env`](.env) if they differ from `127.0.0.1:8080` so that the decoupled frontend can access the JSON content representations in development.

### Compile for production

```bash
npm run build
```

This builds the frontend assets and saves them to the `public` directory and the index file as a Kirby template to `site/templates/default.php`.

Finally, deploy your project and point your web server to the `public` folder.

### Deployment

1. Deploy the whole repository on the server of your choice.
2. Install npm dependencies and build the frontend assets.
3. Set `debug` to `false` in [`site/config/config.php`](site/config/config.php).
4. Point your web server to the `public` directory as main entry point.

## Config

All development-related configurations are located in the [`env`](.env) file:
- `KIRBY_SERVER_HOSTNAME` and `KIRBY_SERVER_PORT` specifies the adress where you want it served

You can define variables for your backend and frontend code in the same file.

## Credits

Big thanks to Jakub Medvecký Heretik for his inspirational work on [kirby-vue-starterkit](https://github.com/jmheretik/kirby-vue-starterkit).

## License

[MIT](https://opensource.org/licenses/MIT)

It is discouraged to use this plugin in any project that promotes racism, sexism, homophobia, animal abuse, violence or any other form of hate speech.
